<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Work - Lewis McIntyre</title>

    <!--Custom CSS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
    <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../Styles.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.css" rel="stylesheet">
</head>

<body>

    <!-- Navbar -->
    <section id="navbar" class="">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="../index.html">Lewis McIntyre</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/showreel.html">Showreel</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/all-work.html">All Work</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="/blog.html">Blog</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/index.html#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </nav>
    </section>

    <!--Page Content-->
    <section id="content" class="">
        <div class="container">
            <div class="row justify-content-center align-items-center">
                <div class="col-md-0">
                    <!-- Introduction -->
                    <section id="introduction" class="py-0 text-center">
                        <!--Title-->
                        <div class="container py-lg-2">
                            <h1 class="fw-light"><a href="/all-work/reveal.html">Reveal Prototype</a> - Visuals
                            </h1>
                            <p class="lead text-body-secondary">February 23rd, 2024</p>
                            Links: <a href="https://lewismci.itch.io/reveal-puzzle-prototype">Itch.io</a> <a href="https://github.com/LewisMcI/Reveal-Shader">GitHub</a>
                        </div>

                        <!--Navigation-->
                        <h4 class="text-center">Quick Navigation</h4>
                        <div class="d-flex flex-column justify-content-center align-items-center">
                            <div class="btn-group">
                                <button type="button" style="margin-right:5px;"
                                    class="btn btn-outline-primary btn-sm mb-3"
                                    onclick="scrollToSection('goal')">Goal</button>
                                <button type="button" style="margin-right:5px;"
                                    class="btn btn-outline-primary btn-sm mb-3"
                                    onclick="scrollToSection('paragraph1')">Code Conversion</button>
                                <button type="button" style="margin-right:5px;"
                                    class="btn btn-outline-primary btn-sm mb-3"
                                    onclick="scrollToSection('final')">Final</button>
                            </div>
                        </div>
                    </section>

                    <hr>

                    <!--Goal-->
                    <section id="goal">
                        <div class="container">
                            <div class="row py-lg-2">
                                <h1 class="fw-light">Goal</h1>
                                <p class="lead text-body-secondary">The inspiration for this project was from the horror
                                    game 'The Voidness'.
                                    This game uses a LiDAR detector to map out the world in real time.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/TheVoidness.jpg" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Image From: <a
                                            href="https://store.steampowered.com/app/2276850/The_Voidness__Lidar_Horror_Survival_Game/">The
                                            Voidness Steam Page</a></p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> The technique of hiding visuals until
                                    light interacts with them was interesting to me and a few friends, and so in 2022 we
                                    created a puzzle game titled 'Luminous'. This project, which was successful, was also too highly scoped,
                                    as we included online multiplayer and three levels within a 12 week deadline and myself
                                    as the only programmer. This created limitations within the scope of the project, visuals and 
                                    lighting being a major factor.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Luminus.jpg" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Image From: <a
                                            href="https://github.com/LewisMcI/Luminous">Luminous
                                            GitHub</a></p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> The main limiting factor, and the goal of this project, is to address
                                    the lighting within this game. The shader was initially created using HLSL for Unity's base Render Pipeline,
                                    which is extremely limited in terms of lighting and visual support. As such, this prototype aims to update 
                                    the shader code to use Unity's Universal Render Pipeline, allowing more interesting visuals.
                                </p>
                            </div>
                        </div>
                    </section>

                    <br>

                    <!--paragraph1-->
                    <section id="paragraph1">
                        <div class="container">
                            <div class="row py-lg-2">
                                <h1 class="fw-light">Code Conversion</h1>
                                <p class="lead text-body-secondary">The initial code we're working with can be found below. To briefly explain its functionality, 
                                    we use Unity's SpotLight system to visualize the values we're using. These values are LightPosition, LightRotation, LightAngle, Colour and LightRange.
                                    We pass each of these into the shader on each frame, and then each fragment computes how brightly it should be lit.
                                </p>
                            </div>
                            <section id="codesnippet">
                                <div class="container py-lg-2">
                                    <button class="code-button" data-toggle="collapse" data-target="#codeSnippet1"
                                        aria-expanded="false" aria-controls="codeSnippet">
                                        <span style="font-family: monospace;">&lt;/&gt;</span>
                                    </button>
                                    <div class="collapse" id="codeSnippet1">
                                        <pre><code class="language-csharp">
Shader "Reveal Object with Light"
{
Properties
{
    _Color("Color", Color) = (1,1,1,1)
    _MainTex("Albedo (RGB)", 2D) = "white" {}
    _Glossiness("Smoothness", Range(0,1)) = 0.5
    _Metallic("Metallic", Range(0,1)) = 0.0
    _Alpha("Alpha", Range(0,1)) = 0.0
    _LightDirection("Light Direction", Vector) = (0,0,1,0)
    _LightPosition("Light Position", Vector) = (0,0,0,0)
    _LightAngle("Light Angle", Range(0,180)) = 45
    _StrengthScalar("Strength", Float) = 50
    _StrengthDistance("StrengthDist", Float) = 0
    _RequirementsMet("Visible", Float) = 0
}
    SubShader
    {
        Tags{ "RenderType" = "Transparent" "Queue" = "Transparent" }
        Blend SrcAlpha OneMinusSrcAlpha
        LOD 200
        CGPROGRAM
        #pragma surface SurfaceReveal Standard fullforwardshadows alpha:fade
        #pragma target 3.0

        sampler2D _MainTex;
        struct Input
        {
            float2 UVMainTex;
            float3 worldPos;
        };//Struct end

        half   _Glossiness;
        half   _Metallic;
        fixed4 _Color;
        half Alpha;
        float4 _LightPosition;
        float4 _LightDirection;
        float  _LightAngle;
        float  _StrengthScalar;
        float  _StrengthDistance;

        void SurfaceReveal(Input input, inout SurfaceOutputStandard R)
        {
            float3 Dir = normalize(_LightPosition - input.worldPos);
            float  Scale = dot(Dir, _LightDirection);
            float  Strength = clamp(Scale - cos(_LightAngle * (UNITY_PI / 360.0)), 0, 1);
            Strength = clamp(Strength *	 * _StrengthDistance, 0, 1);
            fixed4 RC = tex2D(_MainTex, input.UVMainTex) * _Color;
            R.Albedo = RC.rgb;
            R.Metallic = _Metallic;
            R.Smoothness = _Glossiness;
            R.Alpha = Strength * RC.a;

        }
    ENDCG
    }
FallBack "Diffuse"
}
                                    </code></pre>
                                    </div>
                                </div>
                            </section>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary">To convert this, first we create an Unlit Shader Graph and create the variables described earlier.
                                    We must also add in and expose a Texture2D for the objects texture, and a Strength Scalar to control the power of the material.                                    
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Variables.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Variables</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary">Now to calculate we need to calculate the intensity for each fragment. We're going to
                                    copy exactly what was done in the code snippet seen above, and replace the Color variable with our new Texture2D.                                
                                </p>
                                <p class="lead text-body-secondary">First we calculate the ideal direction, which would display the current fragment fully.                          
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Dir.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Ideal Direction</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> Next we use the dot product of the lights forward direction, and the ideal direction to
                                    get all intersections.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Scale.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Visible Intersections</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> This then needs to be constrained to the Light Angles circle, which gives us exactly  where the light
                                    is hitting for each fragment.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/LightHit.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Constrained Light Hit</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> This then needs to be constrained to the Light Angles circle, which gives us exactly  where the light
                                    is hitting for each fragment.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/LightHit.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Constrained Light Hit</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> Next we must calculate the final strength, by applying the exposed Strength Scalar, and 
                                    calculating the Strength Distance found by the distance between the objects position, and the lights position.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Strength.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Constrained Light Hit</p>
                                </div>
                            </div>
                            <div class="row py-lg-2">
                                <p class="lead text-body-secondary"> Finally, this is all applied to the textures alpha to get our final result.
                                </p>
                            </div>
                            <div class="container">
                                <div class="text-center">
                                    <img src="../images/Blogs/Reveal/Apply.png" class="img-fluid"
                                        alt="The Voidness Image">
                                </div>
                                <div class="text-center mt-3">
                                    <p>Constrained Light Hit</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <br>

                    <!--final-->
                    <section id="final">
                        <div class="container">
                            <div class="row py-lg-2">
                                <h1 class="fw-light">Final</h1>

                                <p class="lead text-body-secondary">To finish this, we pass through the variables _Light_Position, _Light_Direction, _Light_Angle and _Range.
                                    These references can be changed within the shader on each of the variables. The code to pass these variables is provided below.
                                </p>
                                <section id="codesnippet">
                                    <div class="container py-lg-2">
                                        <button class="code-button" data-toggle="collapse" data-target="#codeSnippet1"
                                            aria-expanded="false" aria-controls="codeSnippet">
                                            <span style="font-family: monospace;">&lt;/&gt;</span>
                                        </button>
                                        <div class="collapse" id="codeSnippet1">
                                            <pre><code class="language-csharp">
using UnityEngine;

public class ActivateLight : MonoBehaviour
{
    [SerializeField] Material revealMat;
    Light light;


    private void Awake()
    {
        light = GetComponent<Light>();
    }

    private void Update()
    {
        UpdateShader();
    }
    void UpdateShader()
    {
        revealMat.SetVector("_Light_Position", light.transform.position);
        revealMat.SetVector("_Light_Direction", -light.transform.forward);
        revealMat.SetFloat("_Light_Angle", light.spotAngle);
        revealMat.SetFloat("_Range", light.range);
    }
}

                                        </code></pre>
                                        </div>
                                    </div>
                                </section>
                                <p class="lead text-body-secondary">Below are some provided visuals of the final product. There is definitely some optimisation to be made, for 
                                    instance, we update many variables that do not change, Range being a main example. We could create a check for each variable to see if 
                                    it has been updated this frame, and if so, only then will we pass it through.
                                </p>
                                <p class="lead text-body-secondary">We also do not yet support multiple light sources, which could be a possible avenue for future development.
                                </p>
                            </div>
                            <div class="text-center">
                                <img style="max-height: 200px;" src="/images/Blogs/Reveal/WorkingReveal.gif" class="img-fluid"
                                    alt="Animated GIF">
                                    <img style="max-height: 200px;" src="/images/Blogs/Reveal/Blockout.jpg" class="img-fluid"
                                    alt="Level">
                                    <img style="max-height: 200px;" src="/images/Blogs/Reveal/SeparateBlocks.jpg" class="img-fluid"
                                    alt="Level">
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </section>
<br>    

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3">
        <div class="container">
            <p>&copy; 2024 Lewis McIntyre · Portfolio. All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and jQuery (optional) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-csharp.min.js"></script>


    <script>
        function scrollToSection(sectionId) {
            var section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: "smooth", block: "start" });
            }
        }
    </script>

</body>

</html>